\lottjudgement{Typing And Elaboration}{Γ_{I} \lottsym{;} \, Γ_{C} \, \lottsym{⊢} \, pgm \, \pgmtypingsym \, σ \, \lottsym{⇝} \, \targetpre E \targetpost}{
\lottinferencerule{cls}{
\lotthypothesis{\lottjudgementcomprehension{TC'_{i} \, \lottsym{:} \, κ \, \lottsym{⇝} \, \targetpre A'_{i} \targetpost \, \lottsym{∈} \, Γ_{C}}}\\
\lotthypothesis{TC \, \lottsym{∉} \, \lottkw{dom} \lottsym{(} Γ_{C} \lottsym{)}}\\
\lotthypothesis{m \, \lottsym{∉} \, \lottkw{dom} \lottsym{(} Γ_{C} \lottsym{)}}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \lottsym{,} \, a \, \lottsym{:} \, κ \, \lottsym{⊢} \, σ₀ \, \kindingsym \, \lottsym{\star} \, \lottsym{⇝} \, \targetpre \targetpre A \targetpost \targetpost}\\
\lotthypothesis{Γ_{I} \lottsym{;} \, Γ_{C} \lottsym{,} \, \lottsym{(} \lottsepbycomprehension{TC'_{i} \, a \, \lottsym{⇝} \, \targetpre A'_{i} \targetpost} \, \lottsym{⇒} \, TC \, a \, \lottsym{:} \, κ \lottsym{)} \, \lottsym{↦} \, m \, \lottsym{:} \, σ₀ \, \lottsym{⇝} \, \targetpre A \targetpost \, \lottsym{⊢} \, pgm \, \pgmtypingsym \, σ₁ \, \lottsym{⇝} \, \targetpre E \targetpost}
}{Γ_{I} \lottsym{;} \, Γ_{C} \, \lottsym{⊢} \, \lottkw{class} \, \lottsepbycomprehension{TC'_{i} \, a} \, \lottsym{⇒} \, TC \, a \, \lottsym{:} \, κ \, \lottkw{where} \, \lottsym{\{} m \, \lottsym{:} \, σ₀ \lottsym{\}} \lottsym{;} \, pgm \, \pgmtypingsym \, σ₁ \, \lottsym{⇝} \, \targetpre E \targetpost}
\lottinferencerulesep
\lottinferencerule{inst}{
\lotthypothesis{\lottsym{(} \lottsepbycomprehension{TC'_{i} \, a' \, \lottsym{⇝} \, \targetpre A'_{i} \targetpost} \, \lottsym{⇒} \, TC \, a' \, \lottsym{:} \, κ \lottsym{)} \, \lottsym{↦} \, m \, \lottsym{:} \, σ₀ \, \lottsym{⇝} \, \targetpre A \targetpost \, \lottsym{∈} \, Γ_{C}}\\
\lotthypothesis{\lottjudgementcomprehension{Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \lottsym{,} \, \lottsepbycomprehension{a_{k} \, \lottsym{:} \, κ'_{k}} \, \lottsym{⊢} \, ψ_{j} \, \kindingsym \, \lottkw{C} \, \lottsym{⇝} \, \targetpre \targetpre B_{j} \targetpost \targetpost}}\\
\lotthypothesis{\lottjudgementcomprehension{Γ_{I} \lottsym{;} \, Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \lottsym{,} \, \lottsepbycomprehension{a_{k} \, \lottsym{:} \, κ'_{k}} \lottsym{,} \, \lottsepbycomprehension{ψ_{j} \, \lottsym{⇝} \, \targetpre x_{j} \targetpost} \, \solvingsym \, TC'_{i} \, τ \, \lottsym{⇝} \, \targetpre \targetpre \targetpre E'_{i} \targetpost \targetpost \targetpost}}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \lottsym{,} \, \lottsepbycomprehension{a_{k} \, \lottsym{:} \, κ'_{k}} \, \lottsym{⊢} \, τ \, \kindingsym \, κ \, \lottsym{⇝} \, \targetpre \targetpre B' \targetpost \targetpost}\\
\lotthypothesis{Γ_{I} \lottsym{;} \, Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \lottsym{,} \, \lottsepbycomprehension{a_{k} \, \lottsym{:} \, κ'_{k}} \lottsym{,} \, \lottsepbycomprehension{ψ_{j} \, \lottsym{⇝} \, \targetpre x_{j} \targetpost} \, \lottsym{⊢} \, M \, \typingsym \, σ₀\left[τ/a'\right] \, \lottsym{⇝} \, \targetpre \targetpre \targetpre E \targetpost \targetpost \targetpost}\\
\lotthypothesis{Γ_{I} \lottsym{,} \, \lottsym{(} \lottsym{∀} \, \lottsepbycomprehension{a_{k} \, \lottsym{:} \, κ'_{k}} \lottsym{.} \, \lottsepbycomprehension{ψ_{j} \, \lottsym{⇝} \, \targetpre x_{j} \targetpost} \, \lottsym{⇒} \, TC \, τ \lottsym{)} \, \lottsym{⇝} \, \targetpre E \targetpost \lottsym{;} \, \lottsepbycomprehension{\targetpre E'_{i} \targetpost} \lottsym{;} \, Γ_{C} \, \lottsym{⊢} \, pgm \, \pgmtypingsym \, σ₁ \, \lottsym{⇝} \, \targetpre F \targetpost}
}{Γ_{I} \lottsym{;} \, Γ_{C} \, \lottsym{⊢} \, \lottkw{instance} \, \lottsepbycomprehension{ψ_{j}} \, \lottsym{⇒} \, TC \, τ \, \lottkw{where} \, \lottsym{\{} m \, \lottsym{=} \, M \lottsym{\}} \lottsym{;} \, pgm \, \pgmtypingsym \, σ₁ \, \lottsym{⇝} \, \targetpre F \targetpost}
\lottinferencerulesep
\lottinferencerule{term}{
\lotthypothesis{Γ_{I} \lottsym{;} \, Γ_{C} \lottsym{;} \, \lottsym{\epsilon} \, \lottsym{⊢} \, M \, \typingsym \, σ \, \lottsym{⇝} \, \targetpre E \targetpost}
}{Γ_{I} \lottsym{;} \, Γ_{C} \, \lottsym{⊢} \, M \, \pgmtypingsym \, σ \, \lottsym{⇝} \, \targetpre E \targetpost}
}
