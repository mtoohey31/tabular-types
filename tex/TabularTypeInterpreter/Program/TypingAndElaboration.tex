\lottjudgement{Typing And Elaboration}{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \, \lottsym{⊢} \, \sourcepre pgm \sourcepost \, \lottsym{:} \, \sourcepre σ \sourcepost \, \lottsym{⇝} \, \targetpre E \targetpost}{\lottinferencerule{cls}{\lotthypothesis{\lottjudgementcomprehension{\sourcepre {TCₛ}_{i} \sourcepost \, \lottsym{:} \, \sourcepre κ \sourcepost \, \lottsym{⇝} \, \targetpre {Aₛ}_{i} \targetpost \, \lottsym{∈} \, \sourcepre Γ_{C} \sourcepost}} \\ \lotthypothesis{\sourcepre TC \sourcepost \, \lottsym{∉} \, \lottkw{dom} \lottsym{(} \sourcepre Γ_{C} \sourcepost \lottsym{)}} \\ \lotthypothesis{\sourcepre m \sourcepost \, \lottsym{∉} \, \lottkw{dom} \lottsym{(} \sourcepre Γ_{C} \sourcepost \lottsym{)}} \\ \lotthypothesis{\sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \sourcepre \epsilon \sourcepost \lottsym{,} \, \sourcepre a \sourcepost \, \lottsym{:} \, \sourcepre κ \sourcepost \sourcepost \, \lottsym{⊢} \, \sourcepre \sourcepre σ₀ \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre \star \sourcepost \, \lottsym{⇝} \, \targetpre \targetpre A \targetpost \targetpost} \\ \lotthypothesis{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre \sourcepre Γ_{C} \sourcepost \lottsym{,} \, \sourcepre \lottsym{(} \lottsepbycomprehension{\sourcepre {TCₛ}_{i} \sourcepost \, \sourcepre a \sourcepost \, \lottsym{⇝} \, \targetpre {Aₛ}_{i} \targetpost} \, \lottsym{⇒} \, \sourcepre TC \sourcepost \, \sourcepre a \sourcepost \, \lottsym{:} \, \sourcepre κ \sourcepost \lottsym{)} \, \lottsym{↦} \, \sourcepre m \sourcepost \, \lottsym{:} \, \sourcepre σ₀ \sourcepost \, \lottsym{⇝} \, \targetpre A \targetpost \sourcepost \sourcepost \, \lottsym{⊢} \, \sourcepre pgm \sourcepost \, \lottsym{:} \, \sourcepre σ₁ \sourcepost \, \lottsym{⇝} \, \targetpre E \targetpost}}{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \, \lottsym{⊢} \, \sourcepre \lottkw{class} \, \lottsepbycomprehension{\sourcepre {TCₛ}_{i} \sourcepost \, \sourcepre a \sourcepost} \, \lottsym{⇒} \, \sourcepre TC \sourcepost \, \sourcepre a \sourcepost \, \lottsym{:} \, \sourcepre κ \sourcepost \, \lottkw{where} \, \lottsym{\{} \sourcepre m \sourcepost \, \lottsym{:} \, \sourcepre σ₀ \sourcepost \lottsym{\}} \lottsym{;} \, \sourcepre pgm \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre σ₁ \sourcepost \, \lottsym{⇝} \, \targetpre E \targetpost} \lottinferencerulesep \lottinferencerule{inst}{\lotthypothesis{\sourcepre \lottsym{(} \lottsepbycomprehension{\sourcepre {TCₛ}_{i} \sourcepost \, \sourcepre a' \sourcepost \, \lottsym{⇝} \, \targetpre {Aₛ}_{i} \targetpost} \, \lottsym{⇒} \, \sourcepre TC \sourcepost \, \sourcepre a' \sourcepost \, \lottsym{:} \, \sourcepre κ₀ \sourcepost \lottsym{)} \, \lottsym{↦} \, \sourcepre m \sourcepost \, \lottsym{:} \, \sourcepre σ₀ \sourcepost \, \lottsym{⇝} \, \targetpre A \targetpost \sourcepost \, \lottsym{∈} \, \sourcepre Γ_{C} \sourcepost} \\ \lotthypothesis{\lottjudgementcomprehension{\sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \sourcepre \epsilon \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre {a}_{k} \sourcepost \, \lottsym{:} \, \sourcepre {κ₁}_{k} \sourcepost} \sourcepost \, \lottsym{⊢} \, \sourcepre \sourcepre \sourcepre \sourcepre {ψ}_{j} \sourcepost \sourcepost \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre \lottkw{C} \sourcepost \, \lottsym{⇝} \, \targetpre \targetpre {B}_{j} \targetpost \targetpost}} \\ \lotthypothesis{\lottjudgementcomprehension{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \sourcepre \sourcepre \epsilon \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre {a}_{k} \sourcepost \, \lottsym{:} \, \sourcepre {κ₁}_{k} \sourcepost} \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre \sourcepre {ψ}_{j} \sourcepost \sourcepost \, \lottsym{⇝} \, \targetpre {x}_{j} \targetpost} \sourcepost \, \lottsym{⊨} \, \sourcepre \sourcepre {TCₛ}_{i} \sourcepost \, \sourcepre \sourcepre τ \sourcepost \sourcepost \sourcepost \, \lottsym{⇝} \, \targetpre \targetpre \targetpre {Eₛ}_{i} \targetpost \targetpost \targetpost}} \\ \lotthypothesis{\sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \sourcepre \epsilon \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre {a}_{k} \sourcepost \, \lottsym{:} \, \sourcepre {κ₁}_{k} \sourcepost} \sourcepost \, \lottsym{⊢} \, \sourcepre \sourcepre \sourcepre \sourcepre τ \sourcepost \sourcepost \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre κ₀ \sourcepost \, \lottsym{⇝} \, \targetpre \targetpre B' \targetpost \targetpost} \\ \lotthypothesis{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \sourcepre \sourcepre \epsilon \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre {a}_{k} \sourcepost \, \lottsym{:} \, \sourcepre {κ₁}_{k} \sourcepost} \sourcepost \, \lottsym{,} \, \, \lottsepbycomprehension{\sourcepre \sourcepre {ψ}_{j} \sourcepost \sourcepost \, \lottsym{⇝} \, \targetpre {x}_{j} \targetpost} \sourcepost \, \lottsym{⊢} \, \sourcepre \sourcepre \sourcepre M \sourcepost \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre \sourcepre σ₀ \sourcepost\left[\sourcepre \sourcepre \sourcepre τ \sourcepost \sourcepost \sourcepost/\sourcepre a' \sourcepost\right] \sourcepost \, \lottsym{⇝} \, \targetpre \targetpre \targetpre E \targetpost \targetpost \targetpost} \\ \lotthypothesis{\sourcepre \sourcepre Γ_{I} \sourcepost \lottsym{,} \, \sourcepre \lottsym{(} \lottsym{∀} \, \lottsepbycomprehension{\sourcepre {a}_{k} \sourcepost \, \lottsym{:} \, \sourcepre {κ₁}_{k} \sourcepost} \lottsym{.} \, \lottsepbycomprehension{\sourcepre {ψ}_{j} \sourcepost \, \lottsym{⇝} \, \targetpre {x}_{j} \targetpost} \, \lottsym{⇒} \, \sourcepre TC \sourcepost \, \sourcepre τ \sourcepost \lottsym{)} \, \lottsym{↦} \, \targetpre E \targetpost \lottsym{;} \, \lottsepbycomprehension{\targetpre {Eₛ}_{i} \targetpost} \sourcepost \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \, \lottsym{⊢} \, \sourcepre pgm \sourcepost \, \lottsym{:} \, \sourcepre σ₁ \sourcepost \, \lottsym{⇝} \, \targetpre F \targetpost}}{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \, \lottsym{⊢} \, \sourcepre \lottkw{instance} \, \lottsepbycomprehension{\sourcepre {ψ}_{j} \sourcepost} \, \lottsym{⇒} \, \sourcepre TC \sourcepost \, \sourcepre τ \sourcepost \, \lottkw{where} \, \lottsym{\{} \sourcepre m \sourcepost \, \lottsym{=} \, \sourcepre M \sourcepost \lottsym{\}} \lottsym{;} \, \sourcepre pgm \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre σ₁ \sourcepost \, \lottsym{⇝} \, \targetpre F \targetpost} \lottinferencerulesep \lottinferencerule{term}{\lotthypothesis{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \lottsym{;} \, \sourcepre \epsilon \sourcepost \, \lottsym{⊢} \, \sourcepre M \sourcepost \, \lottsym{:} \, \sourcepre σ \sourcepost \, \lottsym{⇝} \, \targetpre E \targetpost}}{\sourcepre Γ_{I} \sourcepost \lottsym{;} \, \sourcepre Γ_{C} \sourcepost \, \lottsym{⊢} \, \sourcepre \sourcepre M \sourcepost \sourcepost \, \lottsym{:} \, \sourcepre σ \sourcepost \, \lottsym{⇝} \, \targetpre E \targetpost}}
