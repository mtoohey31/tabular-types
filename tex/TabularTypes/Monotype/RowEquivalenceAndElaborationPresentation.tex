\lottjudgement{Row Equivalence And Elaboration}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \rowequivsym_{μ} \, ρ₁ \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}{
\lottinferencerule{refl}{
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ \, \kindingsym \, \lottkw{R}^{κ} \, \lottsym{⇝} \, \targetpre A \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ \, \lottsym{⇝} \, \targetpre K \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ \, \rowequivsym_{μ} \, ρ \, \lottsym{⇝} \, \targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊗} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost \lottsym{,} \, \targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊕} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost}
\lottinferencerulesep
\lottinferencerule{trans}{
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \kindingsym \, \lottkw{R}^{κ} \, \lottsym{⇝} \, \targetpre A₀ \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ \, \lottsym{⇝} \, \targetpre K \targetpost}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \rowequivsym_{μ} \, ρ₁ \, \lottsym{⇝} \, \targetpre Fₚ₀₁ \targetpost \lottsym{,} \, \targetpre Fₛ₀₁ \targetpost}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₁ \, \rowequivsym_{μ} \, ρ₂ \, \lottsym{⇝} \, \targetpre Fₚ₁₂ \targetpost \lottsym{,} \, \targetpre Fₛ₁₂ \targetpost}\\
\lottlet{\targetpre Fₚ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊗} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre A₀ \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre \targetpre Fₚ₁₂ \targetpost \, \lottsym{[} \targetpre \targetpre a \targetpost \targetpost \lottsym{]} \targetpost \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre Fₚ₀₁ \targetpost \, \lottsym{[} \targetpre \targetpre a \targetpost \targetpost \lottsym{]} \targetpost \, \targetpre \targetpre x \targetpost \targetpost \targetpost \lottsym{)} \targetpost \targetpost \targetpost \targetpost}\\
\lottlet{\targetpre Fₛ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊕} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre A₀ \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre \targetpre Fₛ₁₂ \targetpost \, \lottsym{[} \targetpre \targetpre a \targetpost \targetpost \lottsym{]} \targetpost \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre Fₛ₀₁ \targetpost \, \lottsym{[} \targetpre \targetpre a \targetpost \targetpost \lottsym{]} \targetpost \, \targetpre \targetpre x \targetpost \targetpost \targetpost \lottsym{)} \targetpost \targetpost \targetpost \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \rowequivsym_{μ} \, ρ₂ \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}
\lottinferencerulesep
\lottinferencerule{comm}{
\lotthypothesis{\lottsym{⊢}_\mathcal{T} \, p \, \lottkw{permutes} \, \lottsym{[} \lottsym{:} n \lottsym{]} \, \lottkw{for} \, ξ}\\
\lotthypothesis{\lottsym{⊢}_\mathcal{T} \, p' \, \lottkw{permutes} \, \lottsym{[} \lottsym{:} n \lottsym{]} \, \lottkw{for} \, ξ}\\
\lotthypothesis{p \, \lottkw{inverts} \, p' \, \lottkw{on} \, \lottsym{[} \lottsym{:} n \lottsym{]}}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottsym{⟨} \lottsepbycomprehensionpatcollection{ξ_{i} \, \lottsym{▹} \, τ_{i}}{i}{[:n]} \lottsym{⟩} \, \kindingsym \, \lottkw{R}^{κ} \, \lottsym{⇝} \, \targetpre \lottsym{\{} \lottsepbycomprehensionpatcollection{\targetpre A_{i} \targetpost}{i}{[:n]} \lottsym{\}} \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ \, \lottsym{⇝} \, \targetpre K \targetpost}\\
\lottlet{\targetpre Fₚ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊗} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre \lottsym{\{} \lottsepbycomprehensionpatcollection{\targetpre A_{i} \targetpost}{i}{[:n]} \lottsym{\}} \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{(} \lottsepbycomprehensioncustom{\targetpre \lottsym{π}_{i} \, \targetpre \targetpre x \targetpost \targetpost \targetpost}{i \in p} \lottsym{)} \targetpost \targetpost \targetpost}\\
\lottlet{\targetpre Fₛ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊕} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a \targetpost \targetpost \, \lottsym{⟦} \targetpre \lottsym{\{} \lottsepbycomprehensionpatcollection{\targetpre A_{i} \targetpost}{i}{[:n]} \lottsym{\}} \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \lottkw{case} \, \targetpre \targetpre x \targetpost \targetpost \, \lottsym{\{} \lottsepbycomprehensioncustom{\targetpre \lottsym{λ} \, \targetpre x' \targetpost \, \lottsym{:} \, \targetpre \targetpre \targetpre a \targetpost \targetpost \, \targetpre A_{i} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{ι}_{j} \, \targetpre \targetpre x' \targetpost \targetpost \targetpost \targetpost}{i \in [:n], j \in p'} \lottsym{\}} \targetpost \targetpost \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottsym{⟨} \lottsepbycomprehensionpatcollection{ξ_{i} \, \lottsym{▹} \, τ_{i}}{i}{[:n]} \lottsym{⟩} \, \rowequivsym_{\mathfrak{c}} \, \lottsym{⟨} \lottsepbycomprehensioncustom{ξ_{i} \, \lottsym{▹} \, τ_{i}}{i \in p} \lottsym{⟩} \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}
\lottinferencerulesep
\lottinferencerule{lift}{
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \rowequivsym_{μ} \, ρ₁ \, \lottsym{⇝} \, \targetpre Fₚ' \targetpost \lottsym{,} \, \targetpre Fₛ' \targetpost}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, ρ₀ \, \kindingsym \, \lottkw{R}^{κ₀}}\\
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \lottsym{,} \, a \, \lottsym{:} \, κ₀ \, \lottsym{⊢} \, τ \, \kindingsym \, κ₁ \, \lottsym{⇝} \, \targetpre \targetpre A \targetpost \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ₀ \, \lottsym{⇝} \, \targetpre K₀ \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ₁ \, \lottsym{⇝} \, \targetpre K₁ \targetpost}\\
\lottlet{\targetpre Fₚ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K₁ \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre Fₚ' \targetpost \, \lottsym{[} \targetpre \lottsym{λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre K₀ \targetpost \lottsym{.} \, \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \targetpre A \targetpost \targetpost \targetpost \lottsym{]} \targetpost \targetpost}\\
\lottlet{\targetpre Fₛ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K₁ \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre Fₛ' \targetpost \, \lottsym{[} \targetpre \lottsym{λ} \, \targetpre a \targetpost \, \lottsym{:} \, \targetpre K₀ \targetpost \lottsym{.} \, \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \targetpre A \targetpost \targetpost \targetpost \lottsym{]} \targetpost \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ \lottsym{)} \, ρ₀ \, \rowequivsym_{μ} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ \lottsym{)} \, ρ₁ \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}
\lottinferencerulesep
\lottinferencerule{liftL}{
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ' \lottsym{)} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ_{i}} \lottsym{⟩} \, \kindingsym \, \lottkw{R}^{κ₁} \, \lottsym{⇝} \, \targetpre A \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ₁ \, \lottsym{⇝} \, \targetpre K \targetpost}\\
\lottlet{\targetpre Fₚ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊗} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost}\\
\lottlet{\targetpre Fₛ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊕} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ' \lottsym{)} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ_{i}} \lottsym{⟩} \, \rowequivsym_{μ} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ'\left[τ_{i}/a\right]} \lottsym{⟩} \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}
\lottinferencerulesep
\lottinferencerule{liftR}{
\lotthypothesis{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ' \lottsym{)} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ_{i}} \lottsym{⟩} \, \kindingsym \, \lottkw{R}^{κ₁} \, \lottsym{⇝} \, \targetpre A \targetpost}\\
\lotthypothesis{\lottsym{⊢} \, κ₁ \, \lottsym{⇝} \, \targetpre K \targetpost}\\
\lottlet{\targetpre Fₚ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊗} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost}\\
\lottlet{\targetpre Fₛ \targetpost}{\targetpre \lottsym{Λ} \, \targetpre a' \targetpost \, \lottsym{:} \, \targetpre \targetpre K \targetpost \, \lottsym{↦} \, \targetpre \lottsym{\star} \targetpost \targetpost \lottsym{.} \, \targetpre \lottsym{λ} \, \targetpre x \targetpost \, \lottsym{:} \, \targetpre \lottsym{⊕} \, \targetpre \lottsym{(} \targetpre \targetpre \targetpre a' \targetpost \targetpost \, \lottsym{⟦} \targetpre A \targetpost \lottsym{⟧} \targetpost \lottsym{)} \targetpost \targetpost \lottsym{.} \, \targetpre \targetpre x \targetpost \targetpost \targetpost \targetpost}
}{Γ_{C} \lottsym{;} \, Γ \, \lottsym{⊢} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ'\left[τ_{i}/a\right]} \lottsym{⟩} \, \rowequivsym_{μ} \, \lottkw{Lift} \, \lottsym{(} \lottsym{λ} \, a \, \lottsym{:} \, κ₀ \lottsym{.} \, τ' \lottsym{)} \, \lottsym{⟨} \lottsepbycomprehension{ξ_{i} \, \lottsym{▹} \, τ_{i}} \lottsym{⟩} \, \lottsym{⇝} \, \targetpre Fₚ \targetpost \lottsym{,} \, \targetpre Fₛ \targetpost}
}
